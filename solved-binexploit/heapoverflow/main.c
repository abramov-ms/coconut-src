#include <stdio.h>
#include <stdlib.h>
#include <string.h>

typedef struct data {
  char bytes[64];
} data_t;

typedef struct function {
  void (*ptr)();
  char pad[sizeof(data_t) - sizeof(void (*)())];
} function_t;

void win() {
  printf("You won!\n");
}

void lose() {
  printf("You lost\n");
}

int main(int argc, const char* argv[]) {
  if (argc != 2) {
    fprintf(stderr, "usage: %s DATA\n", argv[0]);
    return EXIT_FAILURE;
  }

  data_t* data = malloc(sizeof(data_t));
  function_t* function = malloc(sizeof(function_t));
  function->ptr = &lose;

  printf("Data @ %p, function @ %p, function pointer @ %p\n", data, function,
         function->ptr);
  fflush(stdout);

  strcpy(data->bytes, argv[1]);
  function->ptr();

  return EXIT_SUCCESS;
}
